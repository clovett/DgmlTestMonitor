<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<h1><span style='background:white'>DGML Test Modeling</span></h1>

<p class=MsoNormal><span style='background:white'>Download Source Code: </span><span
style='font-size:9.5pt;line-height:115%;font-family:Consolas;color:black;
background:white'><a href="DgmlTestModeling.zip">DgmlTestModel.zip</a> (300kb)
including binaries.</span><span style='background:white'>       </span></p>

<p class=MsoNormal>See also Demo Video: 
    (<a href="http://www.lovettsoftware.com/videos/DgmlTestModel.wmv">WMV 26mb</a>) 
    (<a href="http://www.lovettsoftware.com/videos/DgmlTestModel.mp4"><span>MP4 24mb</span></a>).   
</p>

<p class=MsoNormal>The <a
href="Microsoft.VisualStudio.DgmlTestModeling.xml">Microsoft.VisualStudio.DgmlTestModeling.dll</a>
library contains the <span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>DgmlTestModel </span>class which you can use to execute a DGML
test model. The execution state is writen to a named pipe so that the <a
href="http://visualstudiogallery.msdn.microsoft.com/98723e6a-bbfe-4c10-864c-6354415e254c">DGML
Test Monitor</a> VSIX package can animate the progress during test execution.  
Included in the download is a <a href="SampleTestModel.dgml">SampleTestModel.dgml</a> which shows how to author a DGML test model.</p>

<h3>Example</h3>

<p class=MsoNormal>To execute the model in an MSTest method do the following:</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'> [</span><span style='font-size:9.5pt;font-family:
Consolas;color:#2B91AF;background:white'>TestMethod</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>]</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'> </span><span style='font-size:9.5pt;font-family:
Consolas;color:blue;background:white'>public</span><span style='font-size:9.5pt;
font-family:Consolas;color:black;background:white'> </span><span
style='font-size:9.5pt;font-family:Consolas;color:blue;background:white'>void</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>
RunModel()</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'> { </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>     </span><span style='font-size:9.5pt;
font-family:Consolas;color:green;background:white'>// This test executes a
model of what and end user might want to do</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>     </span><span style='font-size:9.5pt;
font-family:Consolas;color:green;background:white'>// The model is described in
DGML</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>     </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>try</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>     {                </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>int</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> seed
= </span><span style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;
background:white'>Environment</span><span style='font-size:9.5pt;font-family:
Consolas;color:black;background:white'>.TickCount;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         var random = </span><span
style='font-size:9.5pt;font-family:Consolas;color:blue;background:white'>new</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> </span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>Random</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>(seed);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         TestContext.WriteLine(</span><span
style='font-size:9.5pt;font-family:Consolas;color:#A31515;background:white'>&quot;Model
Seed = &quot;</span><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'> + seed);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
.5in;line-height:normal;text-autospace:none'><span style='font-size:9.5pt;
font-family:Consolas;color:black;background:white'>  var model = </span><span
style='font-size:9.5pt;font-family:Consolas;color:blue;background:white'>new</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> </span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>DgmlTestModel</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>(</span><span
style='font-size:9.5pt;font-family:Consolas;color:blue;background:white'>this</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>, </span><span
style='font-size:9.5pt;font-family:Consolas;color:blue;background:white'>new</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> </span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>TestLog</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>(TestContext),
random);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>string</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> path
= </span><span style='font-size:9.5pt;
font-family:Consolas;color:black;background:white'>System.IO.</span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>Path</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>.Combine(</span><span
style='font-size:9.5pt;font-family:Consolas;color:blue;background:white'>this</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>.TestContext.TestDir,
</span><span style='font-size:9.5pt;font-family:Consolas;color:#A31515;
background:white'>@&quot;..\..\Tests\TestModel.dgml&quot;</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         model.Load(path);</span></p>
    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>int</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>
delay = 0; </span><span style='font-size:9.5pt;font-family:Consolas;color:green;
background:white'>// 1000 is handy for debugging.</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         model.Run(</span><span style='font-size:
9.5pt;font-family:Consolas;color:blue;background:white'>new</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> </span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>Predicate</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>&lt;</span><span
style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;background:white'>DgmlTestModel</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>&gt;((m)
=&gt; { <br>
              </span><span style='font-size:9.5pt;font-family:Consolas;
color:blue;background:white'>return</span><span style='font-size:9.5pt;
font-family:Consolas;color:black;background:white'> m.StatesExecuted &gt; 500; </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>         }), delay);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>     </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>      } </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>catch</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> {</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>          </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>string</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> temp
= </span><span style='font-size:9.5pt;font-family:Consolas;color:#2B91AF;
background:white'>Path</span><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>.GetTempPath() + </span><span style='font-size:
9.5pt;font-family:Consolas;color:#A31515;background:white'>&quot;\\Screen.png&quot;</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>          </span><span style='font-size:9.5pt;
font-family:Consolas;color:#2B91AF;background:white'>Win32</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>.CaptureScreen(temp,
System.Drawing.Imaging.</span><span style='font-size:9.5pt;font-family:Consolas;
color:#2B91AF;background:white'>ImageFormat</span><span style='font-size:9.5pt;
font-family:Consolas;color:black;background:white'>.Png);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>          TestContext.WriteLine(</span><span
style='font-size:9.5pt;font-family:Consolas;color:#A31515;background:white'>&quot;ScreenCapture:
&quot;</span><span style='font-size:9.5pt;font-family:Consolas;color:black;
background:white'> + temp);</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>          </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>throw</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'>;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>      }</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>      </span><span style='font-size:9.5pt;
font-family:Consolas;color:blue;background:white'>finally</span><span
style='font-size:9.5pt;font-family:Consolas;color:black;background:white'> </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>      {</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>          Terminate();</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'>      }</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:9.5pt;font-family:Consolas;
color:black;background:white'> }</span></p>
    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'>&nbsp;</p>

<p class=MsoNormal>
    The following picture shows the model executing inside VS using the DGML Test Monitor.
    </p>
    <p class=MsoNormal>
    <img src="Preview.png" />
    </p>
</div>

</body>

</html>
